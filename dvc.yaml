stages:
  _check-env-main:
    cmd: calkit check environment --name main
    deps:
    - requirements.txt
    outs:
    - .calkit/env-locks/main.txt:
        cache: false
        persist: true
    always_changed: true
    desc: Automatically generated by Calkit. Changes made here will be 
      overwritten.
  _clean-nb-run-notebook:
    cmd: calkit nb clean "notebook.ipynb"
    deps:
    - notebook.ipynb
    outs:
    - .calkit/notebooks/cleaned/notebook.ipynb:
        cache: false
    desc: Automatically generated from the 'run-notebook' stage in calkit.yaml. 
      Changes made here will be overwritten.
  run-notebook:
    cmd: calkit nb execute --environment main --no-check --to html 
      "notebook.ipynb"
    deps:
    - .calkit/notebooks/cleaned/notebook.ipynb
    - .calkit/env-locks/main.txt
    outs:
    - .calkit/notebooks/executed/notebook.ipynb:
        cache: false
    - .calkit/notebooks/html/notebook.html:
        cache: true
    desc: Automatically generated from the 'run-notebook' stage in calkit.yaml. 
      Changes made here will be overwritten.
  get-data:
    cmd: calkit xenv -n main -- python 
      ".calkit/notebook-stages/get-data/script.py"
    deps:
    - .calkit/notebook-stages/get-data/script.py
    outs:
    - .calkit/notebook-stages/get-data/outs/df.parquet
  plot:
    cmd: calkit xenv -n main -- python ".calkit/notebook-stages/plot/script.py"
    deps:
    - .calkit/notebook-stages/get-data/outs/df.parquet
    - .calkit/notebook-stages/plot/script.py
    outs:
    - .calkit/notebook-stages/plot/outs/fig.pickle
    - figures/plot.png
